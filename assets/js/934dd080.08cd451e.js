"use strict";(self.webpackChunksipa_js_doc=self.webpackChunksipa_js_doc||[]).push([[9658],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>d});var a=n(7294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function r(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var s=a.createContext({}),p=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},c=function(e){var t=p(e.components);return a.createElement(s.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},u=a.forwardRef((function(e,t){var n=e.components,o=e.mdxType,i=e.originalType,s=e.parentName,c=r(e,["components","mdxType","originalType","parentName"]),u=p(n),d=o,h=u["".concat(s,".").concat(d)]||u[d]||m[d]||i;return n?a.createElement(h,l(l({ref:t},c),{},{components:n})):a.createElement(h,l({ref:t},c))}));function d(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var i=n.length,l=new Array(i);l[0]=u;var r={};for(var s in t)hasOwnProperty.call(t,s)&&(r[s]=t[s]);r.originalType=e,r.mdxType="string"==typeof e?e:o,l[1]=r;for(var p=2;p<i;p++)l[p]=n[p];return a.createElement.apply(null,l)}return a.createElement.apply(null,n)}u.displayName="MDXCreateElement"},2046:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>l,default:()=>m,frontMatter:()=>i,metadata:()=>r,toc:()=>p});var a=n(7462),o=(n(7294),n(3905));const i={sidebar_position:1},l="SipaComponent",r={unversionedId:"guides/guides-extras/sipa-component",id:"guides/guides-extras/sipa-component",title:"SipaComponent",description:"With SipaComponent, Sipa provides a very easy to use, powerful basic component to encapsulate logic.",source:"@site/docs/guides/guides-extras/sipa-component.md",sourceDirName:"guides/guides-extras",slug:"/guides/guides-extras/sipa-component",permalink:"/docs/guides/guides-extras/sipa-component",draft:!1,editUrl:"https://github.com/sipa-js/sipa-js.github.io/edit/master/docs/guides/guides-extras/sipa-component.md",tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1},sidebar:"tutorialSidebar",previous:{title:"Advanced",permalink:"/docs/category/advanced"},next:{title:"Using translations",permalink:"/docs/guides/guides-extras/using-translations"}},s={},p=[{value:"Use case",id:"use-case",level:2},{value:"Features",id:"features",level:2},{value:"Create a new component",id:"create-a-new-component",level:2},{value:"Component Structure",id:"component-structure",level:2},{value:"Explanation",id:"explanation",level:3},{value:"Using and initializing your component",id:"using-and-initializing-your-component",level:2},{value:"Declarative initialization",id:"declarative-initialization",level:3},{value:"Initialize programatically",id:"initialize-programatically",level:3},{value:"Nesting components",id:"nesting-components",level:2}],c={toc:p};function m(e){let{components:t,...n}=e;return(0,o.kt)("wrapper",(0,a.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"sipacomponent"},"SipaComponent"),(0,o.kt)("p",null,"With SipaComponent, Sipa provides a very easy to use, powerful basic component to encapsulate logic."),(0,o.kt)("p",null,"Compared to components in other frameworks, SipaComponent is much easier and simpler."),(0,o.kt)("p",null,"It is just HTML/Javascript without any transpiling, that runs directly in your browser."),(0,o.kt)("p",null,"The API documentation for ",(0,o.kt)("a",{parentName:"p",href:"/docs/api/SipaComponent"},"SipaComponent")," can be found ",(0,o.kt)("a",{parentName:"p",href:"/docs/api/SipaComponent"},"here"),"."),(0,o.kt)("h2",{id:"use-case"},"Use case"),(0,o.kt)("p",null,"The typical use cases to use SipaComponent are custom form elements as well as more complex gui logic,\nthat you want to reuse more often or at least encapsulate into smaller, logical pieces."),(0,o.kt)("h2",{id:"features"},"Features"),(0,o.kt)("p",null,"SipaComponent has the following features:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Templating with ",(0,o.kt)("a",{parentName:"li",href:"https://ejs.co/"},"EJS")," - so it's pure Javascript"),(0,o.kt)("li",{parentName:"ul"},"Component nesting - reuse components inside components"),(0,o.kt)("li",{parentName:"ul"},"Global Scope and access from its ComponentClass"),(0,o.kt)("li",{parentName:"ul"},"Integrated support for classes on the maine element (including its state management)"),(0,o.kt)("li",{parentName:"ul"},"Integrated support for hide/show (including its state management)"),(0,o.kt)("li",{parentName:"ul"},"Easy access to nested or parent components by aliases"),(0,o.kt)("li",{parentName:"ul"},"Auto support to render only if data changes or component is in view area (TODO)"),(0,o.kt)("li",{parentName:"ul"},"Declarative and programmatically use and initialization")),(0,o.kt)("h2",{id:"create-a-new-component"},"Create a new component"),(0,o.kt)("p",null,"To create a new component, just run the Sipa generator by "),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"sipa g\n")),(0,o.kt)("p",null,"and select ",(0,o.kt)("inlineCode",{parentName:"p"},"component"),"."),(0,o.kt)("p",null,"This will create a new component inside ",(0,o.kt)("inlineCode",{parentName:"p"},"app/assets/components")," consisting of a prepared template of a Javascript and Stylesheet file."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"\u251c\u2500\u2500 app\n\u2502 \u2514\u2500\u2500 assets\n\u2502   \u2514\u2500\u2500components\n\u2502     \u2514\u2500\u2500 example-component\n\u2502       \u251c\u2500\u2500 example-component.js\n\u2502       \u2514\u2500\u2500 example-component.(s)css\n")),(0,o.kt)("p",null,"If you only want to use this component on a special page as page encapsulation, then create a subfolder ",(0,o.kt)("inlineCode",{parentName:"p"},"components")," in your page directory and move the component directory inside it. E.g. ",(0,o.kt)("inlineCode",{parentName:"p"},"app/views/pages/my-page/components/example-component")," and rerun ",(0,o.kt)("inlineCode",{parentName:"p"},"sipa i"),"."),(0,o.kt)("h2",{id:"component-structure"},"Component Structure"),(0,o.kt)("p",null,"The new component template looks like this:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript",metastring:'title="example-component.js"',title:'"example-component.js"'},'class ExampleComponent extends SipaComponent {\n    constructor(data = {}, opts = {}) {\n        // define your defaults here\n        data.example ??= "world";\n        super(data, opts);\n    }\n\n    onInit() {\n        // this is called after the view is added to the DOM\n    }\n\n    onDestroy() {\n        // this is called, before the component is destroyed by destroy()\n    }\n\n    showAlert() {\n        alert(`Bye, bye, ${this._data.example}!`);\n    }\n}\n\n//--- TEMPLATE ---------------------------------------------------------------------------------------------------------\n\nExampleComponent.template = () => {\n    return `\n<example-component onclick="instance(this).showAlert();" class="template-class">\n    <span>Hello <%= example =>!</span>\n</example-component>\n    `.trim();\n}\n\nSipaComponent.registerComponent(ExampleComponent);\n')),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-scss",metastring:'title="example-component.(s)css"',title:'"example-component.(s)css"'},"example-component {\n\n}\n")),(0,o.kt)("h3",{id:"explanation"},"Explanation"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Component classes are usually named with the prefix ",(0,o.kt)("inlineCode",{parentName:"li"},"Component")," and inherit from the ",(0,o.kt)("inlineCode",{parentName:"li"},"SipaComponent"),". It's tag name is the same name in ",(0,o.kt)("inlineCode",{parentName:"li"},"dash-case"),"."),(0,o.kt)("li",{parentName:"ul"},"Default values can be set in the constructor by ",(0,o.kt)("inlineCode",{parentName:"li"},'data.my_value ??= "default value"'),"."),(0,o.kt)("li",{parentName:"ul"},"Data state is stored in the ",(0,o.kt)("inlineCode",{parentName:"li"},"_data")," attribute of the class. It is not really private by purpose to give you the full control, if you need it."),(0,o.kt)("li",{parentName:"ul"},"To access instance methods of your component inside your template, use ",(0,o.kt)("inlineCode",{parentName:"li"},"instance(this)")," to get your instance class. It is a shortcut for ",(0,o.kt)("inlineCode",{parentName:"li"},"ExampleComponent.instanceOfElement(this)")),(0,o.kt)("li",{parentName:"ul"},"The template is defined by a static ",(0,o.kt)("inlineCode",{parentName:"li"},"template")," method. The template itself supports ",(0,o.kt)("a",{parentName:"li",href:"https://ejs.co/"},"EJS")," for templating. In EJS you have access to all children variables of ",(0,o.kt)("inlineCode",{parentName:"li"},"_data"),". You can also access the ",(0,o.kt)("inlineCode",{parentName:"li"},"_meta")," by ",(0,o.kt)("inlineCode",{parentName:"li"},"_meta.my_variable"),"."),(0,o.kt)("li",{parentName:"ul"},"The component must be registered to the SipaComponent, to unleash its full power! (or to work at all)")),(0,o.kt)("h2",{id:"using-and-initializing-your-component"},"Using and initializing your component"),(0,o.kt)("p",null,"You can either initialize your components declarative or programmatically, depending on your needs."),(0,o.kt)("h3",{id:"declarative-initialization"},"Declarative initialization"),(0,o.kt)("p",null,"For declarative initialization you can embed your component on any page inside the HTML."),(0,o.kt)("p",null,"Data parameters are given by attribute names. If you want to overwrite or add some real attribute to the initialized instance, use the prefix ",(0,o.kt)("inlineCode",{parentName:"p"},"attr-"),"."),(0,o.kt)("p",null,"Furthermore there are special attributes with the prefix ",(0,o.kt)("inlineCode",{parentName:"p"},"sipa-")," to provide special features."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-html",metastring:'title="my-page.html"',title:'"my-page.html"'},'<div id="some-container">\n    <example-component example="\'Pinky\'" other="1+1" attr-style="color: red;" attr-class="declarative-class" sipa-hidden="true"></example-component>\n</div>\n')),(0,o.kt)("p",null,"In this example we pass the data ",(0,o.kt)("inlineCode",{parentName:"p"},"example")," with the string value ",(0,o.kt)("inlineCode",{parentName:"p"},"Pinky"),". Ensure to put the string in quotes, as the value inside the example attribute is pure javascript. You can also put in numbers or even run some code.\nWe also use the integrated hide/show feature and instance the component in hidden state."),(0,o.kt)("p",null,"The result of this example will be the following, rendered component:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-html",metastring:'title="rendered page DOM"',title:'"rendered',page:!0,'DOM"':!0},'<div id="some-container">\n    <example-component sipa-id="1" style="color: red;" class="template-class declarative-class">\n        <span>Hello Pinky!</span>\n    </example-component>\n</div>\n')),(0,o.kt)("p",null,"Classes on the components tag level are managed automatically, if their attribute is used twice, they will be merged."),(0,o.kt)("p",null,"Let's access the instance of the element on the console and retrieve its data:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},'c = ExampleComponent.all()[0]; // get first instance of ExampleComponent\nconsole.log(c.data());\n// => { example: "Pinky", other: 2 }\n')),(0,o.kt)("p",null,"If we update the component, the state will be set and the view be rerendered."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},'    c = ExampleComponent.bySipaId(1);\n    c.update({ example: "Crocodile"});\n    c.removeClass("declarative-class");\n    c.addClass("super-class");\n')),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-html",metastring:'title="updated DOM"',title:'"updated','DOM"':!0},'<div id="some-container">\n    <example-component sipa-id="1" style="color: red;" class="template-class super-class">\n        <span>Hello Crocodile!</span>\n    </example-component>\n</div>\n')),(0,o.kt)("p",null,"Be aware, never to manipulate classes externally on your own, as their state will not be stored. Always store your state in ",(0,o.kt)("inlineCode",{parentName:"p"},"_data")," and respect the values with EJS inside your teamplate. When you use the ",(0,o.kt)("inlineCode",{parentName:"p"},"removeClass()")," or ",(0,o.kt)("inlineCode",{parentName:"p"},"addClass()")," provided by SipaComponent, it will take care of its state internally. So if you rerender your component, the state will remain. If you would manipulate the DOM externally, your changes will dissappear after the next render."),(0,o.kt)("p",null,"The initialization of declarative components can be done manually, especially when adding new components the declarative way dynamically.\nOtherwise by default, they are initialized in the page init hook of your Sipa app:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript",metastring:'title="app/config/hooks.js"',title:'"app/config/hooks.js"'},"// ...\nSipaHooks.beforeInitPage('on', () => {\n    // This will initialize all registered SipaComponents and its inherited components in the DOM\n    SipaComponent.init();\n    // This would only initialize all ExampleComponents in the DOM\n    // ExampleComponent.init();\n});\n// ...\n")),(0,o.kt)("h3",{id:"initialize-programatically"},"Initialize programatically"),(0,o.kt)("p",null,"The same result as shown before the declarative way can be archived by the following HTML and Javascript code:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-html",metastring:'title="my-page.html"',title:'"my-page.html"'},'<div id="some-container">\n</div>\n')),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript",metastring:'title="my-page.js"',title:'"my-page.js"'},'class MyPage extends SipaBasicView {\n    // ...\n    onInit() {\n        const c = new ExampleComponent({ \n            example: "Pinky", \n            other: 1 + 1, \n            sipa_hidden: true, \n            sipa_custom_attributes: { style: "color: red"}}\n        );\n        c.append("#some-container"); // append the instance to the container\n        // We can also prepend the instance to the container:        \n        // c.prepend("#some-container");\n    }\n    // ...\n}\n')),(0,o.kt)("h2",{id:"nesting-components"},"Nesting components"),(0,o.kt)("p",null,"You are able to nest components and make complex compositions for components in components."),(0,o.kt)("p",null,"To do so, you have to embed them in your ",(0,o.kt)("inlineCode",{parentName:"p"},"template()")," method the declarative way."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript",metastring:'title="car-component.js"',title:'"car-component.js"'},'// ...\nCarComponent.template = () => {\n    return `\n<car-component onclick="instance(this).steering_wheel.locked = false;">\n    <h1><%= title %></h1>\n    <steering-wheel-component sipa-alias="steering_wheel" locked="true">\n    <wheel-component sipa-alias="wheel_front_left" state="\'ok\'">\n    <wheel-component sipa-alias="wheel_front_right" state="\'hot\'">\n    <wheel-component sipa-alias="wheel_back_left" state="\'ok\'">\n    <wheel-component sipa-alias="wheel_back_right" state="\'broken\'">\n    <brake-lights-component state="\'<%= brake.put_on ? "on" : "off" %>\'">\n    <starter-component attr-onclick="instance(this).parentTop().wheel_front_left.state = \'hot\';">\n<car-component>    \n    `.trim();\n}\n// ...\n')))}m.isMDXComponent=!0}}]);